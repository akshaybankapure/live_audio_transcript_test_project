import{u as f,j as e}from"./query-vendor-DbbwdUmu.js";import{u as p}from"./router-vendor-CIOyAg1L.js";import{C as r,a as l,b as c,c as d,d as N}from"./card-CGlLgBal.js";import{B as v}from"./badge-6FZ8YVdM.js";import{S as n}from"./index-Dae1gTR_.js";import{h as x,i as b,j as y,C as w,k as C}from"./ui-vendor-tvosxp_B.js";import"./react-vendor-B9B04VyU.js";function F(){const[,m]=p(),{data:t,isLoading:i}=f({queryKey:["/api/dashboard/overview"]}),u=s=>s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Never",h=(t==null?void 0:t.devices.length)||0,j=(t==null?void 0:t.devices.reduce((s,a)=>s+a.sessionCount,0))||0,g=(t==null?void 0:t.devices.reduce((s,a)=>s+a.flagCount,0))||0,o=(t==null?void 0:t.devices.filter(s=>s.sessionCount>0).length)||0;return e.jsxs("div",{className:"container mx-auto p-6 space-y-6","data-testid":"page-dashboard",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight","data-testid":"text-dashboard-title",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1","data-testid":"text-dashboard-subtitle",children:"Overview of all devices and groups with session-based data"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(r,{"data-testid":"card-stat-devices",children:[e.jsxs(l,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Devices"}),e.jsx(x,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[i?e.jsx(n,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-devices",children:h}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[o," active"]})]})]}),e.jsxs(r,{"data-testid":"card-stat-sessions",children:[e.jsxs(l,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Sessions"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[i?e.jsx(n,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-sessions",children:j}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all devices"})]})]}),e.jsxs(r,{"data-testid":"card-stat-flags",children:[e.jsxs(l,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Flags"}),e.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[i?e.jsx(n,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-total-flags",children:g}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"All flagged content"})]})]}),e.jsxs(r,{"data-testid":"card-stat-active",children:[e.jsxs(l,{className:"flex flex-row items-center justify-between gap-1 space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Active Devices"}),e.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[i?e.jsx(n,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold","data-testid":"text-active-devices",children:o}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"With recordings"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4","data-testid":"text-devices-header",children:"Devices & Groups"}),i?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(s=>e.jsx(n,{className:"h-48 w-full"},s))}):t&&t.devices.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.devices.map(s=>{const a=s.userId===t.currentUserId;return e.jsxs(r,{className:`hover-elevate active-elevate-2 cursor-pointer transition-all ${a?"border-primary ring-2 ring-primary/20":""}`,onClick:()=>m(`/dashboard/device/${s.userId}`),"data-testid":`card-device-${s.userId}`,children:[e.jsxs(l,{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(c,{className:"text-lg","data-testid":`text-device-name-${s.userId}`,children:s.displayName||"Unknown Device"}),a&&e.jsx(v,{variant:"default","data-testid":"badge-current-user",children:"You"})]}),e.jsxs(N,{"data-testid":`text-device-activity-${s.userId}`,children:["Last active: ",u(s.lastActivity)]})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sessions"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":`text-session-count-${s.userId}`,children:s.sessionCount})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Flags"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:`text-2xl font-bold ${s.flagCount>0?"text-destructive":""}`,"data-testid":`text-flag-count-${s.userId}`,children:s.flagCount}),s.flagCount>0&&e.jsx(C,{className:"h-4 w-4 text-destructive"})]})]})]}),s.sessionCount===0?e.jsx("div",{className:"text-xs text-muted-foreground text-center py-2 border-t",children:"No recordings yet"}):e.jsx("div",{className:"text-xs text-primary font-medium text-center py-2 border-t",children:"Click to view details â†’"})]})]},s.userId)})}):e.jsx(r,{children:e.jsxs(d,{className:"text-center py-12",children:[e.jsx(x,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No devices found"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Start recording to create your first session"})]})})]})]})}export{F as default};
